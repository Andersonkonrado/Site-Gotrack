# =====================================================
# üîí SEGURAN√áA E OTIMIZA√á√ÉO - GOTRACK RASTREAMENTO
# =====================================================

# For√ßar HTTPS (redireciona todo o tr√°fego para HTTPS)
RewriteEngine On
RewriteCond %{HTTPS} !=on
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Remover barra final da URL (SEO friendly)
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.+)/$ /$1 [R=301,L]

# Desativar listagem de diret√≥rios (seguran√ßa)
Options -Indexes

# Ocultar informa√ß√µes do servidor
ServerSignature Off
ServerTokens Prod

# Prote√ß√£o b√°sica contra acesso a arquivos sens√≠veis
<FilesMatch "\.(htaccess|env|log|ini|sh|sql|bak|conf|json)$">
    Order Allow,Deny
    Deny from all
</FilesMatch>

# Bloquear hotlinking de imagens (protege tua banda)
RewriteCond %{HTTP_REFERER} !^$
RewriteCond %{HTTP_REFERER} !^https://(www\.)?gotrack\.com\.br [NC]
RewriteRule \.(jpg|jpeg|png|gif|webp)$ - [F,NC,L]

# =====================================================
# ‚ö° DESEMPENHO E CACHE
# =====================================================

# Ativar cache do navegador
<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresByType image/jpg "access plus 1 year"
  ExpiresByType image/jpeg "access plus 1 year"
  ExpiresByType image/gif "access plus 1 year"
  ExpiresByType image/png "access plus 1 year"
  ExpiresByType image/webp "access plus 1 year"
  ExpiresByType text/css "access plus 1 month"
  ExpiresByType application/javascript "access plus 1 month"
  ExpiresByType text/html "access plus 1 day"
</IfModule>

# Compress√£o GZIP
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript application/json
</IfModule>

# Cache-Control para navegadores modernos
<IfModule mod_headers.c>
  <FilesMatch "\.(jpg|jpeg|png|gif|webp|css|js)$">
    Header set Cache-Control "max-age=2592000, public"
  </FilesMatch>
</IfModule>

# =====================================================
# üîç SEO B√ÅSICO
# =====================================================

# P√°gina de erro personalizada
ErrorDocument 404 /404.html

# For√ßar dom√≠nio com www (opcional - descomente se quiser)
# RewriteCond %{HTTP_HOST} !^www\. [NC]
# RewriteRule ^(.*)$ https://www.%{HTTP_HOST}/$1 [L,R=301]

# =====================================================
# üö´ BLOQUEIOS OPCIONAIS (descomente se quiser)
# =====================================================
# Bloquear acesso via IP espec√≠fico
# Deny from 123.45.67.89
#
# Bloquear bots ruins
# SetEnvIfNoCase User-Agent "MJ12bot" bad_bot
# Order Allow,Deny
# Allow from all
# Deny from env=bad_bot
